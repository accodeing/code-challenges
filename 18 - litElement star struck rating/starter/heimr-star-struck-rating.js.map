{"version":3,"file":"heimr-star-struck-rating.js","sources":["src/heimr-star-struck-rating.js"],"sourcesContent":["class StarStruckRating extends HTMLElement {\n  constructor() {\n    super();\n    const shadowRoot = this.attachShadow({ mode: \"open\" });\n  }\n\n  connectedCallback() {\n    this.stars = this.getAttribute(\"stars\");\n  }\n\n  get rating() {\n    return parseInt(this.getAttribute(\"rating\")) || 0;\n  }\n\n  set rating(val) {\n    let new_value = Math.min(this.stars, parseInt(val) || 0);\n    const change = new_value - this.rating;\n\n    if (change === 0 && new_value === 1) {\n      new_value = 0;\n    }\n\n    this.setAttribute(\"rating\", new_value);\n    this.after_rating_change(change);\n  }\n\n  get stars() {\n    return parseInt(this.getAttribute(\"stars\"));\n  }\n\n  set stars(val) {\n    this.setAttribute(\"stars\", parseInt(val) || 5);\n    this.rating = Math.min(this.rating, this.stars);\n    this.render_stars();\n  }\n\n  render_stars() {\n    Array.from(this.shadowRoot.children).forEach(child => {\n      this.shadowRoot.removeChild(child);\n    });\n\n    for (let i = 1; i <= this.stars; i++) {\n      const child = document.createElement(\"heimr-star-struck\");\n      child.addEventListener(\"change\", () => {\n        this.rating = i;\n      });\n      this.shadowRoot.appendChild(child);\n    }\n    this.after_rating_change(0);\n  }\n\n  after_rating_change(change) {\n    let rating;\n\n    Array.from(this.shadowRoot.children).forEach((child, index) => {\n      child.struck = index < this.rating ? true : false;\n    });\n\n    this.dispatchEvent(\n      new CustomEvent(\"rating_change\", {\n        detail: { rating: this.rating, max: this.stars },\n        composed: true,\n        bubbles: true\n      })\n    );\n  }\n}\n\nwindow.customElements.define(\"heimr-star-struck-rating\", StarStruckRating);\n"],"names":[],"mappings":"AAAA,MAAM,gBAAiB,SAAQ,WAAW;IACxC;QACE,KAAK,EAAE,CAAC;QACR,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;KACxD;IAED,iBAAiB;QACf,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;KACzC;IAED,IAAI,MAAM;QACR,OAAO,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC;KACnD;IAED,IAAI,MAAM,CAAC,GAAG;QACZ,IAAI,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;QACzD,MAAM,MAAM,GAAG,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC;QAEvC,IAAI,MAAM,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,EAAE;YACnC,SAAS,GAAG,CAAC,CAAC;SACf;QAED,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;QACvC,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;KAClC;IAED,IAAI,KAAK;QACP,OAAO,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC;KAC7C;IAED,IAAI,KAAK,CAAC,GAAG;QACX,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;QAC/C,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAChD,IAAI,CAAC,YAAY,EAAE,CAAC;KACrB;IAED,YAAY;QACV,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,KAAK;YAChD,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SACpC,CAAC,CAAC;QAEH,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;YACpC,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;YAC1D,KAAK,CAAC,gBAAgB,CAAC,QAAQ,EAAE;gBAC/B,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;aACjB,CAAC,CAAC;YACH,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SACpC;QACD,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC;KAC7B;IAED,mBAAmB,CAAC,MAAM;QAGxB,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,KAAK;YACxD,KAAK,CAAC,MAAM,GAAG,KAAK,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,KAAK,CAAC;SACnD,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAChB,IAAI,WAAW,CAAC,eAAe,EAAE;YAC/B,MAAM,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,KAAK,EAAE;YAChD,QAAQ,EAAE,IAAI;YACd,OAAO,EAAE,IAAI;SACd,CAAC,CACH,CAAC;KACH;CACF;AAED,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,0BAA0B,EAAE,gBAAgB,CAAC,CAAC"}